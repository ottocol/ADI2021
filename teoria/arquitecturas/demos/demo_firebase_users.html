<html>
<head>
    <meta charset="utf8"/>
    <style>
      #panel {
        display : none;
      }
    </style>
</head>
<body>
    <h1>Demo de gestiÃ³n de usuarios con Firebase</h1>
    <div id="panel">
      EstÃ¡s autentificado como <span id="login_actual"></span>. 
      <a href="javascript:logout()">Salir</a>
    </div>
    Email: <input type="email" id="email"/> <br>
    ContraseÃ±a: <input type="password" id="password"> <br>
    <button id="boton_registrar">Registrarse</button>
    <button id="boton_entrar">Entrar</button>
    <p>SÃ© que es raro que el mismo formulario sirva para registrarse y entrar, pero es solo una demo...ðŸ˜Š</p>

    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->     
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-app.js"></script>      
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-auth.js"></script>
    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDBEyu1g0nN0STWmPIoJhpxSTWLtdarHQw",
            authDomain: "prueba-adi.firebaseapp.com",
            databaseURL: "https://prueba-adi.firebaseio.com",
            projectId: "prueba-adi",
            storageBucket: "prueba-adi.appspot.com",
            messagingSenderId: "391363689319",
            appId: "1:391363689319:web:5130e1c6fb04692b2f0dc2"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.auth().onAuthStateChanged(function(user) {
          if (user) {
            document.getElementById('login_actual').innerText = user.email
            document.getElementById('panel').style.display = 'block'
          } 
          else {
            document.getElementById('panel').style.display = 'hidden'
          }
        });

        document.getElementById('boton_registrar').addEventListener('click', async function(){
          var email = document.getElementById('email').value
          var password = document.getElementById('password').value
          try {
            var user = await firebase.auth().createUserWithEmailAndPassword(email, password)
            console.log(user)
          }
          catch(error) {
            console.log("Error " + error.code + ": " + error.message)
          };
        })
        document.getElementById('boton_entrar').addEventListener('click', async function(){
          var email = document.getElementById('email').value
          var password = document.getElementById('password').value
          try {
            var user = await firebase.auth().signInWithEmailAndPassword(email, password)
            console.log(user)
          }
          catch(error) {
            console.log("Error " + error.code + ": " + error.message)
          };
        })

        

        async function logout() {
           await firebase.auth().signOut()
           document.getElementById('panel').style.display = 'hidden'
        }
    </script>
</body>
</html>